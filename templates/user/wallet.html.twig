{% extends 'base.html.twig' %}

{% block title %}User{% endblock %}

{% block content %}
<div class="connected-interface d-flex" style="height: 100vh;">
  <div class="submenu col-2">
    <!-- Left column content -->
    <table class="w-100">
      <tr>
        <td class="submenu-item p-3">
          <img class="menu-icon" src="{{asset('img/home.svg')}}">
          <a class="submenu-link" href="{{asset('user')}}"><span> Hub</span></a>
        </td>
      </tr>
      {% if is_granted('ROLE_ADMIN') %}
      {# Afficher l'élément HTML si l'utilisateur a le rôle ROLE_ADMIN #}
      <tr>
        <td class="submenu-item p-3">
          <img class="menu-icon" src="{{asset('img/admin.svg')}}">
          <a class="submenu-link" href="{{asset('admin')}}"><span> Administration</span></a>
        </td>
      </tr>
      {% endif %}
      <tr>
        <td class="submenu-item p-3">
          <img class="menu-icon" src="{{asset('img/account.svg')}}">
          <a class="submenu-link" href="{{asset('')}}"><span> Account</span></a>
        </td>
      </tr>
      <tr>
        <td class="submenu-item p-3">
          <img class="menu-icon" src="{{asset('img/wallet.svg')}}"> 
          <a class="submenu-link" href="{{ path('wallet', {id: currentUser.id}) }}">
            <span> Wallet</span>
          </a>
        </td>
      </tr>
    </table>
  </div>
  <div class="right-column bg-light col-10 d-flex flex-column justify-content-start" style="overflow-y: scroll"> 

    <div class="embed-responsive embed-responsive-16by9">
      
      <!-- Votre contenu ici -->
      <h1>User Wallets</h1>
      <p>User ID: {{ userId }}</p>
      <p>User Name: {{ user.email }}</p>

      <div>
      <h2>Add Cryptocurrency</h2>
      {{ form_start(form) }}
        {{ form_row(form.crypto) }}
        {{ form_row(form.quantity) }}
      {{ form_end(form) }}
      </div>

      <div>
        <h2>Sell Cryptocurrency</h2>
        {{ form_start(sellForm) }}
          {{ form_row(sellForm.crypto) }}
          {{ form_row(sellForm.quantity) }}
        {{ form_end(sellForm) }}
      </div>


      <!-- Display flash messages -->
      <div>
        {% for type, messages in app.flashes %}
          {% for message in messages %}
            <div class="alert alert-{{ type }}" role="alert">
              {{ message }}
            </div>
          {% endfor %}
        {% endfor %}
      </div>
      <hr>

      <h2>Wallets:</h2>
      <ul>
          {% for wallet in wallets %}
              <li>
                  Wallet ID: {{ wallet.user.id }},
                  Crypto ID: {{ wallet.cryptoId }},
                  Quantity: {{ wallet.quantity }},
                  Total Cost: {{ wallet.totalCost }}
              </li>
          {% endfor %}
      </ul>

      <div>
        <table class="table">
            <thead>
              <tr>
                <th scope="col">Name</th>
                <th scope="col">Quantity</th>
                <th scope="col">Last price</th>
                <th scope="col">var % 24h</th>
              </tr>
            </thead>
            <tbody class="tbody">
              {% for symbol, data in cryptoData %}
                <tr data-crypto="{{ symbol }}">
                  <td>{{ data.alias }}</td>
                  <td>{{ data.quantity }}</td>
                  <td class="price">{{ data.price }} $</td>
                  <td class="change-percent">{{ data.changePercent }}%</td>
                </tr>
              {% endfor %}
            </tbody>
        </table>
    </div>

    </div>
  </div>
    
  </div>
  </div>
  </div>
</div>
</div>
</div>
{% endblock %}